import settings
import handlers.base_handler
import csv

class CartogramHandler(handlers.base_handler.BaseCartogramHandler):

    def get_name(self):
        return "test130"

    def get_gen_file(self):
        return "{}/test130.geojson".format(settings.CARTOGRAM_DATA_DIR)
    
    def validate_values(self, values):

        if len(values) != 52:
            return False
        
        for v in values:
            if type(v) != float:
                return False

        return True
    
    def gen_area_data(self, values):
        return """cartogram_id,Region Data,Region Name,Inset
1,{},E00016482,
2,{},E00016481,
3,{},E00016760,
4,{},E00173705,
5,{},E00016775,
6,{},E00016762,
7,{},E00016761,
8,{},E00016768,
9,{},E00016467,
10,{},E00016756,
11,{},E00016730,
12,{},E00016478,
13,{},E00016765,
14,{},E00016459,
15,{},E00016729,
16,{},E00016748,
17,{},E00016472,
18,{},E00016477,
19,{},E00016767,
20,{},E00016772,
21,{},E00016466,
22,{},E00016474,
23,{},E00016447,
24,{},E00016766,
25,{},E00016458,
26,{},E00016468,
27,{},E00016773,
28,{},E00016471,
29,{},E00016759,
30,{},E00016469,
31,{},E00016475,
32,{},E00016728,
33,{},E00016777,
34,{},E00016770,
35,{},E00016480,
36,{},E00016769,
37,{},E00016465,
38,{},E00016776,
39,{},E00016737,
40,{},E00016470,
41,{},E00016764,
42,{},E00016464,
43,{},E00173704,
44,{},E00016479,
45,{},E00016473,
46,{},E00016774,
47,{},E00173707,
48,{},E00016463,
49,{},E00016460,
50,{},E00016771,
51,{},E00016731,
52,{},E00016476,""".format(*values)
    
    def expect_geojson_output(self):
        return True

    def csv_to_area_string_and_colors(self, csvfile):

        return self.order_by_example(csv.reader(csvfile), "Region", 0, 1, 2, 3, ["E00016482","E00016481","E00016760","E00173705","E00016775","E00016762","E00016761","E00016768","E00016467","E00016756","E00016730","E00016478","E00016765","E00016459","E00016729","E00016748","E00016472","E00016477","E00016767","E00016772","E00016466","E00016474","E00016447","E00016766","E00016458","E00016468","E00016773","E00016471","E00016759","E00016469","E00016475","E00016728","E00016777","E00016770","E00016480","E00016769","E00016465","E00016776","E00016737","E00016470","E00016764","E00016464","E00173704","E00016479","E00016473","E00016774","E00173707","E00016463","E00016460","E00016771","E00016731","E00016476"], [0.0 for i in range(0,52)], {"E00016482":"1","E00016481":"2","E00016760":"3","E00173705":"4","E00016775":"5","E00016762":"6","E00016761":"7","E00016768":"8","E00016467":"9","E00016756":"10","E00016730":"11","E00016478":"12","E00016765":"13","E00016459":"14","E00016729":"15","E00016748":"16","E00016472":"17","E00016477":"18","E00016767":"19","E00016772":"20","E00016466":"21","E00016474":"22","E00016447":"23","E00016766":"24","E00016458":"25","E00016468":"26","E00016773":"27","E00016471":"28","E00016759":"29","E00016469":"30","E00016475":"31","E00016728":"32","E00016777":"33","E00016770":"34","E00016480":"35","E00016769":"36","E00016465":"37","E00016776":"38","E00016737":"39","E00016470":"40","E00016764":"41","E00016464":"42","E00173704":"43","E00016479":"44","E00016473":"45","E00016774":"46","E00173707":"47","E00016463":"48","E00016460":"49","E00016771":"50","E00016731":"51","E00016476":"52"})
