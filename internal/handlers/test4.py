import settings
import handlers.base_handler
import csv

class CartogramHandler(handlers.base_handler.BaseCartogramHandler):

    def get_name(self):
        return "test04-Demo"

    def get_gen_file(self):
        return "{}/test4.geojson".format(settings.CARTOGRAM_DATA_DIR)
    
    def validate_values(self, values):

        if len(values) != 42:
            return False
        
        for v in values:
            if type(v) != float:
                return False

        return True
    
    def gen_area_data(self, values):
        return """cartogram_id,Region Data,Region Name,Inset
1,{},E00017773,
2,{},E00017746,
3,{},E00017632,
4,{},E00017722,
5,{},E00017761,
6,{},E00018164,
7,{},E00017613,
8,{},E00018167,
9,{},E00017741,
10,{},E00017742,
11,{},E00017628,
12,{},E00017780,
13,{},E00017743,
14,{},E00017740,
15,{},E00017634,
16,{},E00017744,
17,{},E00017727,
18,{},E00017760,
19,{},E00017762,
20,{},E00017728,
21,{},E00017723,
22,{},E00018166,
23,{},E00017763,
24,{},E00017782,
25,{},E00017748,
26,{},E00017747,
27,{},E00017770,
28,{},E00017772,
29,{},E00017778,
30,{},E00017781,
31,{},E00017777,
32,{},E00017629,
33,{},E00018158,
34,{},E00017776,
35,{},E00018165,
36,{},E00017784,
37,{},E00017630,
38,{},E00017739,
39,{},E00017745,
40,{},E00017771,
41,{},E00017631,
42,{},E00017614,""".format(*values)
    
    def expect_geojson_output(self):
        return True

    def csv_to_area_string_and_colors(self, csvfile):

        return self.order_by_example(csv.reader(csvfile), "Region", 0, 1, 2, 3, ["E00017773","E00017746","E00017632","E00017722","E00017761","E00018164","E00017613","E00018167","E00017741","E00017742","E00017628","E00017780","E00017743","E00017740","E00017634","E00017744","E00017727","E00017760","E00017762","E00017728","E00017723","E00018166","E00017763","E00017782","E00017748","E00017747","E00017770","E00017772","E00017778","E00017781","E00017777","E00017629","E00018158","E00017776","E00018165","E00017784","E00017630","E00017739","E00017745","E00017771","E00017631","E00017614"], [0.0 for i in range(0,42)], {"E00017773":"1","E00017746":"2","E00017632":"3","E00017722":"4","E00017761":"5","E00018164":"6","E00017613":"7","E00018167":"8","E00017741":"9","E00017742":"10","E00017628":"11","E00017780":"12","E00017743":"13","E00017740":"14","E00017634":"15","E00017744":"16","E00017727":"17","E00017760":"18","E00017762":"19","E00017728":"20","E00017723":"21","E00018166":"22","E00017763":"23","E00017782":"24","E00017748":"25","E00017747":"26","E00017770":"27","E00017772":"28","E00017778":"29","E00017781":"30","E00017777":"31","E00017629":"32","E00018158":"33","E00017776":"34","E00018165":"35","E00017784":"36","E00017630":"37","E00017739":"38","E00017745":"39","E00017771":"40","E00017631":"41","E00017614":"42"})
